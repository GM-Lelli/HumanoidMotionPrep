# MoMaskUnityBridge

This folder contains the scripts required to integrate Unity with an external Python script from the [MoMask](https://github.com/EricGuo5513/momask-codes) project, in order to generate animations from text prompts and convert them into usable `AnimationClip`s within Unity.

## Contents

### 1. `PythonCommandRunner.cs`

This utility class handles:
- Executing a Python script with specified parameters.
- Building the command to be run in the terminal.
- Validating the script's working directory.
- Retrieving the `.bvh` file generated by MoMask from the output directory.

**Constructor:**
```csharp
PythonCommandRunner(string pythonPath, string scriptName, string workingDirectory)
````

**Main Methods:**

* `ValidateWorkingDirectory()`: Checks whether the working directory exists.
* `BuildCommand(gpuId, extension, textPrompt)`: Builds the command to execute.
* `ExecuteCommand(arguments)`: Executes the Python command and returns the output.
* `GetSpecificFile(extension, fileIndex)`: Returns the path to the generated `.bvh` file.

---

### 2. `RunPythonCommandEditor.cs`

A Unity editor window accessible via the menu `Tools > MoMask`, which allows you to:

1. Enter a text prompt, file extension, GPU ID, and output directory.
2. Execute the `gen_t2m.py` script.
3. Convert the generated `.bvh` file into an `AnimationClip`.
4. Save the `Clip` in the specified folder.

**Python script path and working directory**
These are currently hardcoded as:

```csharp
string pythonPath = "/home/gianmarco/Apps/anaconda3/envs/gm_thesis_4/bin/python";
string scriptName = "gen_t2m.py";
string workingDir = Path.GetFullPath("../dependencies/momask-codes-main");
```

Make sure these paths are valid on your system.

**External Dependencies:**

* The `gen_t2m.py` script must be present in the specified directory.
* Requires the `BVHConvert` class to convert the `.bvh` file into an `AnimationClip`.

---

## Usage

1. Open Unity.
2. Go to `Tools > MoMask`.
3. Enter a text prompt (e.g., "A person is running on a treadmill").
4. Click "Generate Animation".
5. Wait for the process to execute and the animation to be saved.

## Notes

* It is recommended to first test the Python script manually to ensure all dependencies are met.
* Make sure your Python environment is properly configured and accessible.

---